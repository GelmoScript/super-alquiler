@page "/clientes"
<h3>Modulo Clientes</h3>
<button class="btn btn-success" @onclick="() => { AsignarModo(FormModes.Agregar); }">Agregar</button>
@if (Modo != null) { 
    <button class="btn btn-danger" @onclick="LimpiarFormulario">Borrar</button>
}
<FormularioClientes CambioRealizado="Refrescar" Modo="@Modo" Cliente="@clienteActual" ParaCambiarModo="AsignarModo"></FormularioClientes>
<ListaClientes Clientes="_clientes" ParaEditarCliente="EditarCliente" ParaEliminarCliente="EliminarCliente"></ListaClientes>

@code {

    private FormModes? Modo = null;
    private Cliente clienteActual;
    private List<Cliente> _clientes;

    protected override void OnInitialized()
    {
        clienteActual = new Cliente();
        Refrescar();
    }

    void AsignarModo(FormModes? modo)
    {
        Modo = modo;
    }

    protected void EditarCliente(int id)
    {
        ObtenerClientePorId(id);
        AsignarModo(FormModes.Editar);
    }

    protected void EliminarCliente(int id)
    {
        ObtenerClientePorId(id);
        AsignarModo(FormModes.Eliminar);
    }

    protected void LimpiarFormulario()
    {
        clienteActual = new Cliente();
    }

    protected void ObtenerClientePorId(int id)
    {
        CRUDClientes crudClientes = new CRUDClientes();
        clienteActual = crudClientes.SelectByID(id);
    }
    void Refrescar()
    {
        CRUDClientes crudClientes = new CRUDClientes();
        _clientes = crudClientes.Read();
    }
}
